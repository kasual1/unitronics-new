!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.planout=t():e.planout=t()}(this,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}return n.m=e,n.c=t,n.p="",n(0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=(r=n(1))&&r.__esModule?r:{default:r},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(11));t.default=(0,i.default)({Random:o}),e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=p(n(2)),i=p(n(4)),o=f(n(5)),u=p(n(6)),a=f(n(7)),s=f(n(8)),l=f(n(9)),c=p(n(10));function f(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function p(e){return e&&e.__esModule?e:{default:e}}t.default=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).Random,t=void 0===e?null:e;l.initializeOperators(s,t);var n=(0,r.default)(t),f=(0,i.default)(n),p=(0,u.default)(l,n),h=(0,c.default)(t,n,f);return{Assignment:n,Experiment:f,ExperimentSetup:o,Interpreter:p,Ops:{Random:t,Core:s,Base:a},Namespace:h}},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.default=function(e){return function(){function t(e,n){!function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),n||(n={}),this.experimentSalt=e,this._overrides=(0,i.shallowCopy)(n),this._data=(0,i.shallowCopy)(n),this.saltSeparator="."}return r(t,[{key:"evaluate",value:function(e){return e}},{key:"getOverrides",value:function(){return this._overrides}},{key:"addOverride",value:function(e,t){this._overrides[e]=t,this._data[e]=t}},{key:"setOverrides",value:function(e){this._overrides=(0,i.shallowCopy)(e);var t=this;(0,i.forEach)(Object.keys(this._overrides),function(e){t._data[e]=t._overrides[e]})}},{key:"set",value:function(t,n){"_data"!==t?"_overrides"!==t?"experimentSalt"!==t?"saltSeparator"!==t?(0,i.hasKey)(this._overrides,t)||(n instanceof e.PlanOutOpRandom?(n.args.salt||(n.args.salt=t),this._data[t]=n.execute(this)):this._data[t]=n):this.saltSeparator=n:this.experimentSalt=n:this._overrides=n:this._data=n}},{key:"get",value:function(e,t){if("_data"===e)return this._data;if("_overrides"===e)return this._overrides;if("experimentSalt"===e)return this.experimentSalt;if("saltSeparator"===e)return this.saltSeparator;var n=this._data[e];return null===n||void 0===n?t:n}},{key:"getParams",value:function(){return this._data}},{key:"del",value:function(e){delete this._data[e]}},{key:"toString",value:function(){return String(this._data)}},{key:"length",value:function(){return Object.keys(this._data).length}}]),t}()};var i=n(3);e.exports=t.default},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(e){var t=void 0===e?"undefined":n(e);return"function"===t||"object"===t&&!!e},i=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)},o=function(e){return"function"==typeof e||!1},u=function(e){if(!r(e))return[];if(Object.keys)return Object.keys(e);var t=[];for(var n in e)y(e,n)&&t.push(n);return m&&_(e,t),t},a=function(e,t){return function(n){var r=arguments.length;if(r<2||null==n)return n;for(var i=1;i<r;i++)for(var o=arguments[i],u=e(o),a=u.length,s=0;s<a;s++){var l=u[s];t&&void 0!==n[l]||(n[l]=o[l])}return n}},s=a(function(e){if(!r(e))return[];var t=[];for(var n in e)t.push(n);return m&&_(e,t),t}),l=a(u),c=function(e){return e},f=function(e,t,n){if(void 0===t)return e;switch(null==n?3:n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)};case 4:return function(n,r,i,o){return e.call(t,n,r,i,o)}}return function(){return e.apply(t,arguments)}},p=function(e){return function(t){return null==t?void 0:t[e]}},h=Math.pow(2,53)-1,g=p("length"),v=function(e){var t=g(e);return"number"==typeof t&&t>=0&&t<=h},y=function(e,t){return null!=e&&Object.prototype.hasOwnProperty.call(e,t)},m=!{toString:null}.propertyIsEnumerable("toString"),d=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];function _(e,t){var n=d.length,r=e.constructor,i=o(r)&&r.prototype||Object.Prototype,u="constructor";for(y(e,u)&&!O(t,u)&&t.push(u);n--;)(u=d[n])in e&&e[u]!==i[u]&&!O(t,u)&&t.push(u)}var O=function(e,t,n,r){return v(e)||(e=x(e)),("number"!=typeof n||r)&&(n=0),e.indexOf(t)>=0},x=function(e){for(var t=u(e),n=t.length,r=Array(n),i=0;i<n;i++)r[i]=e[t[i]];return r};t.deepCopy=function e(t){var r=t;if(t&&"object"===(void 0===t?"undefined":n(t)))for(var i in r="[object Array]"===Object.prototype.toString.call(t)?[]:{},t)r[i]=e(t[i]);return r},t.map=function(e,t,n){t=function(e,t,n){return null==e?c:o(e)?f(e,t,void 0):r(e)?(i=l({},i=e),function(e){return function(e,t){var n=n(t),r=n.length;if(null==e)return!r;for(var i=Object(e),o=0;o<r;o++){var u=n[o];if(t[u]!==i[u]||!(u in i))return!1}return!0}(e,i)}):p(e);var i}(t,n);for(var i=!v(e)&&u(e),a=(i||e).length,s=Array(a),h=0;h<a;h++){var g=i?i[h]:h;s[h]=t(e[g],g,e)}return s},t.reduce=function(e,t,n,r){t=f(t,r,4);var i=!v(e)&&u(e),o=(i||e).length,a=0;for(arguments.length<3&&(n=e[i?i[a]:a],a+=1);a>=0&&a<o;a++){var s=i?i[a]:a;n=t(n,e[s],s,e)}return n},t.getParameterByName=function(e){var t,n="undefined"!=typeof location,r="undefined"!=typeof window;if(n){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);t=null===i?"":decodeURIComponent(i[1].replace(/\+/g," "))}else t="";return null!==t&&void 0!==t&&0!==t.length||!r||void 0===window.localStorage||null===window.localStorage?t:window.localStorage.getItem(e)},t.forEach=function(e,t,n){var r,i;if(t=f(t,n),v(e))for(r=0,i=e.length;r<i;r++)t(e[r],r,e);else{var o=u(e);for(r=0,i=o.length;r<i;r++)t(e[o[r]],o[r],e)}return e},t.isFunction=o,t.trimTrailingWhitespace=function(e){return e.replace(/^\s+|\s+$/g,"")},t.hasKey=function(e,t){return void 0!==e[t]},t.shallowCopy=function(e){return r(e)?i(e)?e.slice():s({},e):e},t.extend=s,t.isObject=r,t.isArray=i,t.range=function(e){for(var t=[],n=0;n<e;n++)t.push(n);return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.default=function(e){return function(){function t(n){if(function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.inputs=n,this._exposureLogged=!1,this._salt=null,this._inExperiment=!0,this._autoExposureLog=!0,this.setup(),!this.name)throw"setup() must set an experiment name via this.setName()";this._assignment=new e(this.getSalt()),this._assigned=!1}return r(t,[{key:"getDefaultParamNames",value:function(){var e=this.assign.toString().split(".set(");return e.splice(0,1),(0,i.map)(e,function(e){var t=(0,i.trimTrailingWhitespace)(e.split(",")[0]);return t.substr(1,t.length-2)})}},{key:"requireAssignment",value:function(){this._assigned||this._assign()}},{key:"requireExposureLogging",value:function(e){this.shouldLogExposure(e)&&this.logExposure()}},{key:"_assign",value:function(){this.configureLogger();var e=this.assign(this._assignment,this.inputs);this._inExperiment=!(!e&&void 0!==e),this._assigned=!0}},{key:"setup",value:function(){throw"IMPLEMENT setup"}},{key:"inExperiment",value:function(){return this._inExperiment}},{key:"addOverride",value:function(e,t){this._assignment.addOverride(e,t)}},{key:"setOverrides",value:function(e){this._assignment.setOverrides(e);var t=this._assignment.getOverrides(),n=this;(0,i.forEach)(Object.keys(t),function(e){void 0!==n.inputs[e]&&(n.inputs[e]=t[e])})}},{key:"getSalt",value:function(){return this._salt?this._salt:this.name}},{key:"setSalt",value:function(e){this._salt=e,this._assignment&&(this._assignment.experimentSalt=e)}},{key:"getName",value:function(){return this.name}},{key:"assign",value:function(e,t){throw"IMPLEMENT assign"}},{key:"getParamNames",value:function(){throw"IMPLEMENT getParamNames"}},{key:"shouldFetchExperimentParameter",value:function(e){return this.getParamNames().indexOf(e)>=0}},{key:"setName",value:function(e){this.name=e.replace(/\s+/g,"-"),this._assignment&&(this._assignment.experimentSalt=this.getSalt())}},{key:"__asBlob",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={name:this.getName(),time:(new Date).getTime()/1e3,salt:this.getSalt(),inputs:this.inputs,params:this._assignment.getParams()};return(0,i.extend)(t,e),t}},{key:"setAutoExposureLogging",value:function(e){this._autoExposureLog=e}},{key:"getParams",value:function(){return this.requireAssignment(),this.requireExposureLogging(),this._assignment.getParams()}},{key:"get",value:function(e,t){return this.requireAssignment(),this.requireExposureLogging(e),this._assignment.get(e,t)}},{key:"toString",value:function(){return this.requireAssignment(),this.requireExposureLogging(),JSON.stringify(this.__asBlob())}},{key:"logExposure",value:function(e){this.inExperiment()&&(this._exposureLogged=!0,this.logEvent("exposure",e))}},{key:"shouldLogExposure",value:function(e){return!(void 0!==e&&!this.shouldFetchExperimentParameter(e))&&this._autoExposureLog&&!this.previouslyLogged()}},{key:"logEvent",value:function(e,t){var n;this.inExperiment()&&(n=t?{event:e,extra_data:(0,i.shallowCopy)(t)}:{event:e},this.log(this.__asBlob(n)))}},{key:"configureLogger",value:function(){throw"IMPLEMENT configureLogger"}},{key:"log",value:function(e){throw"IMPLEMENT log"}},{key:"previouslyLogged",value:function(){throw"IMPLEMENT previouslyLogged"}}]),t}()};var i=n(3);e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getExperimentInputs=t.registerExperimentInput=void 0;var r=n(3),i={},o={},u=function(e){return e?a((0,r.shallowCopy)(e)):{}},a=function(e){return(0,r.forEach)(Object.keys(e),function(t){(0,r.isFunction)(e[t])&&(e[t]=e[t]())}),e};t.registerExperimentInput=function(e,t,n){n?(o[n]||(o[n]={}),o[n][e]=t):i[e]=t},t.getExperimentInputs=function(e){var t=u(i);return e&&o[e]?(0,r.extend)(t,u(o[e])):t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.default=function(e,t){return function(){function n(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"global_salt",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=arguments[3];!function(e,t){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this),this._serialization=(0,i.deepCopy)(e),this._env=u||new t(r),this.experimentSalt=this._experimentSalt=r,this._evaluated=!1,this._inExperiment=!1,this._inputs=(0,i.shallowCopy)(o)}return r(n,[{key:"inExperiment",value:function(){return this._inExperiment}},{key:"setEnv",value:function(e){return this._env=(0,i.deepCopy)(e),this}},{key:"has",value:function(e){return this._env[e]}},{key:"get",value:function(e,t){var n=this._inputs[e];null!==n&&void 0!==n||(n=t);var r=this._env.get(e);return void 0!==r&&null!==r?r:n}},{key:"getParams",value:function(){if(!this._evaluated){try{this.evaluate(this._serialization)}catch(t){t instanceof e.StopPlanOutException&&(this._inExperiment=t.inExperiment)}this._evaluated=!0}return this._env.getParams()}},{key:"set",value:function(e,t){return this._env.set(e,t),this}},{key:"getSaltSeparator",value:function(){return this._env.saltSeparator}},{key:"setOverrides",value:function(e){return this._env.setOverrides(e),this}},{key:"getOverrides",value:function(){return this._env.getOverrides()}},{key:"hasOverride",value:function(e){var t=this.getOverrides();return t&&void 0!==t[e]}},{key:"registerCustomOperators",value:function(t){e.registerOperators(t)}},{key:"evaluate",value:function(t){if((0,i.isObject)(t)&&t.op)return e.operatorInstance(t).execute(this);if((0,i.isArray)(t)){var n=this;return(0,i.map)(t,function(e){return n.evaluate(e)})}return t}}]),n}()};var i=n(3);e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlanOutOpUnary=t.PlanOutOpBinary=t.PlanOutOpCommutative=t.PlanOutOpSimple=t.PlanOutOp=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(3);function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(t){a(this,e),this.args=t}return r(e,[{key:"execute",value:function(e){throw"Implement the execute function"}},{key:"dumpArgs",value:function(){console.log(this.args)}},{key:"getArgMixed",value:function(e){if(void 0===this.args[e])throw"Missing argument "+e;return this.args[e]}},{key:"getArgNumber",value:function(e){var t=this.getArgMixed(e);if("number"!=typeof t)throw e+" is not a number.";return t}},{key:"getArgString",value:function(e){var t=this.getArgMixed(e);if("string"!=typeof t)throw e+" is not a string.";return t}},{key:"getArgList",value:function(e){var t=this.getArgMixed(e);if("[object Array]"!==Object.prototype.toString.call(t))throw e+" is not a list";return t}},{key:"getArgObject",value:function(e){var t=this.getArgMixed(e);if("[object Object]"!==Object.prototype.toString.call(t))throw e+" is not an object.";return t}},{key:"getArgIndexish",value:function(e){var t=this.getArgMixed(e),n=Object.prototype.toString.call(t);if("[object Object]"!==n&&"[object Array]"!==n)throw e+" is not an list or object.";return t}}]),e}(),l=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,s),r(t,[{key:"execute",value:function(e){this.mapper=e;var t=this;return(0,i.forEach)(Object.keys(this.args),function(n){t.args[n]=e.evaluate(t.args[n])}),this.simpleExecute()}}]),t}(),c=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,l),r(t,[{key:"simpleExecute",value:function(){return this.unaryExecute(this.getArgMixed("value"))}},{key:"getUnaryString",value:function(){return this.args.op}},{key:"unaryExecute",value:function(e){throw"implement unaryExecute"}}]),t}(),f=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,l),r(t,[{key:"simpleExecute",value:function(){var e=this.getArgMixed("left"),t=this.getArgMixed("right");return this.binaryExecute(e,t)}},{key:"getInfixString",value:function(){return this.args.op}},{key:"binaryExecute",value:function(e,t){throw"implement binaryExecute"}}]),t}(),p=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,l),r(t,[{key:"simpleExecute",value:function(){return this.commutativeExecute(this.getArgList("values"))}},{key:"getCommutativeString",value:function(){return this.args.op}},{key:"commutativeExecute",value:function(e){throw"implement commutativeExecute"}}]),t}();t.PlanOutOp=s,t.PlanOutOpSimple=l,t.PlanOutOpCommutative=p,t.PlanOutOpBinary=f,t.PlanOutOpUnary=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Return=t.Length=t.Max=t.Min=t.Negative=t.Not=t.Round=t.Divide=t.Mod=t.GreaterThanOrEqualTo=t.LessThanOrEqualTo=t.LessThan=t.GreaterThan=t.Equals=t.Sum=t.Product=t.Or=t.And=t.Cond=t.Index=t.Coalesce=t.Map=t.Arr=t.Set=t.Seq=t.Get=t.Literal=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(7),o=n(9),u=n(3);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var c=function(e){function t(){return a(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,i.PlanOutOp),r(t,[{key:"execute",value:function(e){return this.getArgMixed("value")}}]),t}(),f=function(e){function t(){return a(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,i.PlanOutOp),r(t,[{key:"execute",value:function(e){return e.get(this.getArgString("var"))}}]),t}(),p=function(e){function t(){return a(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,i.PlanOutOp),r(t,[{key:"execute",value:function(e){(0,u.forEach)(this.getArgList("seq"),function(t){e.evaluate(t)})}}]),t}(),h=function(e){function t(){return a(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,i.PlanOutOp),r(t,[{key:"execute",value:function(e){var t=!1;throw e.evaluate(this.getArgMixed("value"))&&(t=!0),new o.StopPlanOutException(t)}}]),t}(),g=function(e){function t(){return a(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,i.PlanOutOp),r(t,[{key:"execute",value:function(e){var t=this.getArgString("var"),n=this.getArgMixed("value");e.hasOverride(t)||(n&&(0,o.isOperator)(n)&&!n.salt&&(n.salt=t),"experimentSalt"==t&&(e.experimentSalt=n),e.set(t,e.evaluate(n)))}}]),t}(),v=function(e){function t(){return a(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,i.PlanOutOp),r(t,[{key:"execute",value:function(e){return(0,u.map)(this.getArgList("values"),function(t){return e.evaluate(t)})}}]),t}(),y=function(e){function t(){return a(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,i.PlanOutOp),r(t,[{key:"execute",value:function(e){for(var t=this.getArgList("values"),n=0;n<t.length;n++){var r=e.evaluate(t[n]);if(null!==r&&void 0!==r)return r}return null}}]),t}(),m=function(e){function t(){return a(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,i.PlanOutOpSimple),r(t,[{key:"simpleExecute",value:function(){var e=this.getArgIndexish("base"),t=this.getArgMixed("index");return"number"==typeof t?t>=0&&t<e.length?e[t]:void 0:e[t]}}]),t}(),d=function(e){function t(){return a(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,i.PlanOutOp),r(t,[{key:"execute",value:function(e){var t=this.getArgList("cond");for(var n in t){var r=t[n].then;if(e.evaluate(t[n].if))return e.evaluate(r)}return null}}]),t}(),_=function(e){function t(){return a(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,i.PlanOutOp),r(t,[{key:"execute",value:function(e){return(0,u.reduce)(this.getArgList("values"),function(t,n){return t?Boolean(e.evaluate(n)):t},!0)}}]),t}(),O=function(e){function t(){return a(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,i.PlanOutOp),r(t,[{key:"execute",value:function(e){return(0,u.reduce)(this.getArgList("values"),function(t,n){return t||Boolean(e.evaluate(n))},!1)}}]),t}(),x=function(e){function t(){return a(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,i.PlanOutOpCommutative),r(t,[{key:"commutativeExecute",value:function(e){return(0,u.reduce)(e,function(e,t){return e*t},1)}}]),t}(),b=function(e){function t(){return a(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,i.PlanOutOpCommutative),r(t,[{key:"commutativeExecute",value:function(e){return(0,u.reduce)(e,function(e,t){return e+t},0)}}]),t}(),E=function(e){function t(){return a(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,i.PlanOutOpBinary),r(t,[{key:"getInfixString",value:function(){return"=="}},{key:"binaryExecute",value:function(e,t){return e===t}}]),t}(),P=function(e){function t(){return a(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,i.PlanOutOpBinary),r(t,[{key:"binaryExecute",value:function(e,t){return e>t}}]),t}(),k=function(e){function t(){return a(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,i.PlanOutOpBinary),r(t,[{key:"binaryExecute",value:function(e,t){return e<t}}]),t}(),j=function(e){function t(){return a(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,i.PlanOutOpBinary),r(t,[{key:"binaryExecute",value:function(e,t){return e<=t}}]),t}(),w=function(e){function t(){return a(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,i.PlanOutOpBinary),r(t,[{key:"binaryExecute",value:function(e,t){return e>=t}}]),t}(),S=function(e){function t(){return a(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,i.PlanOutOpBinary),r(t,[{key:"binaryExecute",value:function(e,t){return e%t}}]),t}(),A=function(e){function t(){return a(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,i.PlanOutOpBinary),r(t,[{key:"binaryExecute",value:function(e,t){return parseFloat(e)/parseFloat(t)}}]),t}(),M=function(e){function t(){return a(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,i.PlanOutOpUnary),r(t,[{key:"unaryExecute",value:function(e){return Math.round(e)}}]),t}(),L=function(e){function t(){return a(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,i.PlanOutOpUnary),r(t,[{key:"getUnaryString",value:function(){return"!"}},{key:"unaryExecute",value:function(e){return!e}}]),t}(),T=function(e){function t(){return a(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,i.PlanOutOpUnary),r(t,[{key:"getUnaryString",value:function(){return"-"}},{key:"unaryExecute",value:function(e){return 0-e}}]),t}(),B=function(e){function t(){return a(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,i.PlanOutOpCommutative),r(t,[{key:"commutativeExecute",value:function(e){return Math.min.apply(null,e)}}]),t}(),C=function(e){function t(){return a(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,i.PlanOutOpCommutative),r(t,[{key:"commutativeExecute",value:function(e){return Math.max.apply(null,e)}}]),t}(),N=function(e){function t(){return a(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,i.PlanOutOpUnary),r(t,[{key:"unaryExecute",value:function(e){return e.length}}]),t}(),I=function(e){function t(){return a(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,i.PlanOutOpSimple),r(t,[{key:"simpleExecute",value:function(){var e=(0,u.deepCopy)(this.args);return delete e.op,delete e.salt,e}}]),t}();t.Literal=c,t.Get=f,t.Seq=p,t.Set=g,t.Arr=v,t.Map=I,t.Coalesce=y,t.Index=m,t.Cond=d,t.And=_,t.Or=O,t.Product=x,t.Sum=b,t.Equals=E,t.GreaterThan=P,t.LessThan=k,t.LessThanOrEqualTo=j,t.GreaterThanOrEqualTo=w,t.Mod=S,t.Divide=A,t.Round=M,t.Not=L,t.Negative=T,t.Min=B,t.Max=C,t.Length=N,t.Return=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StopPlanOutException=t.operatorInstance=t.isOperator=t.registerOperators=t.initializeOperators=void 0;var r=n(3),i={},o=function(e){(0,r.forEach)(e,function(e,t){if(i[t])throw t+" already is defined";i[t]=e})};t.initializeOperators=function(e,t){o({literal:e.Literal,get:e.Get,set:e.Set,seq:e.Seq,return:e.Return,index:e.Index,array:e.Arr,equals:e.Equals,and:e.And,or:e.Or,">":e.GreaterThan,"<":e.LessThan,">=":e.GreaterThanOrEqualTo,"<=":e.LessThanOrEqualTo,"%":e.Mod,"/":e.Divide,not:e.Not,round:e.Round,negative:e.Negative,min:e.Min,max:e.Max,length:e.Length,coalesce:e.Coalesce,map:e.Map,cond:e.Cond,product:e.Product,sum:e.Sum,randomFloat:t.RandomFloat,randomInteger:t.RandomInteger,bernoulliTrial:t.BernoulliTrial,bernoulliFilter:t.BernoulliFilter,uniformChoice:t.UniformChoice,weightedChoice:t.WeightedChoice,sample:t.Sample})},t.registerOperators=o,t.isOperator=function(e){return(0,r.isObject)(e)&&e.op},t.operatorInstance=function(e){var t=e.op;if(!i[t])throw"Unknown Operator "+t;return new i[t](e)},t.StopPlanOutException=function e(t){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this.inExperiment=t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var u=i.get;return void 0!==u?u.call(r):void 0},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.default=function(e,t,n){var c=function(e){function t(){return a(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,n),i(t,[{key:"configureLogger",value:function(){}},{key:"setup",value:function(){this.name="test_name"}},{key:"log",value:function(e){}},{key:"getParamNames",value:function(){return this.getDefaultParamNames()}},{key:"previouslyLogged",value:function(){return!0}},{key:"assign",value:function(e,t){}}]),t}(),f=function(){function e(){a(this,e)}return i(e,[{key:"addExperiment",value:function(e,t,n){throw"IMPLEMENT addExperiment"}},{key:"removeExperiment",value:function(e){throw"IMPLEMENT removeExperiment"}},{key:"setAutoExposureLogging",value:function(e){throw"IMPLEMENT setAutoExposureLogging"}},{key:"inExperiment",value:function(){throw"IMPLEMENT inExperiment"}},{key:"get",value:function(e,t){throw"IMPLEMENT get"}},{key:"logExposure",value:function(e){throw"IMPLEMENT logExposure"}},{key:"logEvent",value:function(e,t){throw"IMPLEMENT logEvent"}},{key:"requireExperiment",value:function(){this._experiment||this._assignExperiment()}},{key:"requireDefaultExperiment",value:function(){this._defaultExperiment||this._assignDefaultExperiment()}}]),e}();return{Namespace:f,SimpleNamespace:function(n){function p(e){a(this,p);var t=s(this,(p.__proto__||Object.getPrototypeOf(p)).call(this,e));if(t.inputs=e||{},t.numSegments=1,t.segmentAllocations={},t.currentExperiments={},t._experiment=null,t._defaultExperiment=null,t.defaultExperimentClass=c,t._inExperiment=!1,t.setupDefaults(),t.setup(),!t.name)throw"setup() must set a namespace name via this.setName()";return t.availableSegments=(0,o.range)(t.numSegments),t.setupExperiments(),t}return l(p,f),i(p,[{key:"setupDefaults",value:function(){}},{key:"setup",value:function(){throw"IMPLEMENT setup"}},{key:"setupExperiments",value:function(){throw"IMPLEMENT setupExperiments"}},{key:"getPrimaryUnit",value:function(){return this._primaryUnit}},{key:"allowedOverride",value:function(){return!1}},{key:"getOverrides",value:function(){return{}}},{key:"setPrimaryUnit",value:function(e){this._primaryUnit=e}},{key:"addExperiment",value:function(n,r,i){var o=this.availableSegments.length;if(o<i)return!1;if(void 0!==this.currentExperiments[n])return!1;var u=new t(this.name);u.set("sampled_segments",new e.Sample({choices:this.availableSegments,draws:i,unit:n}));for(var a=u.get("sampled_segments"),s=0;s<a.length;s++){this.segmentAllocations[a[s]]=n;var l=this.availableSegments.indexOf(a[s]);this.availableSegments[l]=this.availableSegments[o-1],this.availableSegments.splice(o-1,1),o-=1}this.currentExperiments[n]=r}},{key:"removeExperiment",value:function(e){var t=this;return void 0!==this.currentExperiments[e]&&((0,o.forEach)(Object.keys(this.segmentAllocations),function(n){t.segmentAllocations[n]===e&&(delete t.segmentAllocations[n],t.availableSegments.push(n))}),delete this.currentExperiments[e],!0)}},{key:"getSegment",value:function(){var n=new t(this.name),r=new e.RandomInteger({min:0,max:this.numSegments-1,unit:this.inputs[this.getPrimaryUnit()]});return n.set("segment",r),n.get("segment")}},{key:"_assignExperiment",value:function(){this.inputs=(0,o.extend)(this.inputs,(0,u.getExperimentInputs)(this.getName()));var e=this.getSegment();void 0!==this.segmentAllocations[e]&&this._assignExperimentObject(this.segmentAllocations[e])}},{key:"_assignExperimentObject",value:function(e){var t=new this.currentExperiments[e](this.inputs);t.setName(this.getName()+"-"+e),t.setSalt(this.getName()+"-"+e),this._experiment=t,this._inExperiment=t.inExperiment(),this._inExperiment||this._assignDefaultExperiment()}},{key:"_assignDefaultExperiment",value:function(){this._defaultExperiment=new this.defaultExperimentClass(this.inputs)}},{key:"defaultGet",value:function(e,t){return r(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"requireDefaultExperiment",this).call(this),this._defaultExperiment.get(e,t)}},{key:"getName",value:function(){return this.name}},{key:"setName",value:function(e){this.name=e}},{key:"previouslyLogged",value:function(){return this._experiment?this._experiment.previouslyLogged():null}},{key:"inExperiment",value:function(){return r(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"requireExperiment",this).call(this),this._inExperiment}},{key:"setAutoExposureLogging",value:function(e){this._autoExposureLoggingSet=e,this._defaultExperiment&&this._defaultExperiment.setAutoExposureLogging(e),this._experiment&&this._experiment.setAutoExposureLogging(e)}},{key:"setGlobalOverride",value:function(e){var t=this.getOverrides();if(t&&(0,o.hasKey)(t,e)){var n=t[e];n&&(0,o.hasKey)(this.currentExperiments,n.experimentName)&&(this._assignExperimentObject(n.experimentName),this._experiment.addOverride(e,n.value))}}},{key:"setLocalOverride",value:function(e){var t=(0,o.getParameterByName)("experimentOverride");t&&(0,o.hasKey)(this.currentExperiments,t)&&(this._assignExperimentObject(t),(0,o.getParameterByName)(e)&&this._experiment.addOverride(e,(0,o.getParameterByName)(e)))}},{key:"getParams",value:function(e){return r(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"requireExperiment",this).call(this),this._experiment&&this.getOriginalExperimentName()===e?this._experiment.getParams():null}},{key:"getOriginalExperimentName",value:function(){return this._experiment?this._experiment.getName().split("-")[1]:null}},{key:"get",value:function(e,t){return r(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"requireExperiment",this).call(this),this.allowedOverride()&&this.setGlobalOverride(e),this.setLocalOverride(e),this._experiment?(void 0!==this._autoExposureLoggingSet&&this._experiment.setAutoExposureLogging(this._autoExposureLoggingSet),this._experiment.get(e,this.defaultGet(e,t))):this.defaultGet(e,t)}},{key:"logExposure",value:function(e){r(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"requireExperiment",this).call(this),this._experiment&&this._experiment.logExposure(e)}},{key:"logEvent",value:function(e,t){r(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"requireExperiment",this).call(this),this._experiment&&this._experiment.logEvent(e,t)}}]),p}()}};var o=n(3),u=n(5);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RandomFloat=t.RandomInteger=t.BernoulliTrial=t.BernoulliFilter=t.UniformChoice=t.WeightedChoice=t.Sample=t.PlanOutOpRandom=void 0;var r=n(12),i=(0,r.SampleBuilder)(r.PlanOutOpRandom),o=(0,r.WeightedChoiceBuilder)(r.PlanOutOpRandom),u=(0,r.UniformChoiceBuilder)(r.PlanOutOpRandom),a=(0,r.BernoulliFilterBuilder)(r.PlanOutOpRandom),s=(0,r.BernoulliTrialBuilder)(r.PlanOutOpRandom),l=(0,r.RandomIntegerBuilder)(r.PlanOutOpRandom),c=(0,r.RandomFloatBuilder)(r.PlanOutOpRandom);t.PlanOutOpRandom=r.PlanOutOpRandom,t.Sample=i,t.WeightedChoice=o,t.UniformChoice=u,t.BernoulliFilter=a,t.BernoulliTrial=s,t.RandomInteger=l,t.RandomFloat=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RandomFloatBuilder=t.RandomIntegerBuilder=t.BernoulliTrialBuilder=t.BernoulliFilterBuilder=t.UniformChoiceBuilder=t.WeightedChoiceBuilder=t.SampleBuilder=t.PlanOutOpRandom=void 0;var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=(r=n(13))&&r.__esModule?r:{default:r},u=n(7),a=n(3);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var f=function(e){function t(){return s(this,t),l(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return c(t,u.PlanOutOpSimple),i(t,[{key:"hashCalculation",value:function(e){return parseInt(e.substr(0,13),16)}},{key:"zeroToOneCalculation",value:function(e){return this.getHash(e)/0xfffffffffffff}},{key:"getUnit",value:function(e){var t=this.getArgMixed("unit");return(0,a.isArray)(t)||(t=[t]),e&&t.push(e),t}},{key:"getUniform",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.zeroToOneCalculation(arguments[2])*(t-e)+e}},{key:"getHash",value:function(e){var t;if(this.args.full_salt)t=this.getArgString("full_salt")+".";else{var n=this.getArgString("salt");t=this.mapper.get("experimentSalt")+"."+n+this.mapper.get("saltSeparator")}var r=this.getUnit(e).map(function(e){return String(e)}).join("."),i=(0,o.default)(t+r);return this.hashCalculation(i)}}]),t}();t.PlanOutOpRandom=f,t.SampleBuilder=function(e){return function(t){function n(){return s(this,n),l(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return c(n,e),i(n,[{key:"sampleIndexCalculation",value:function(e){return this.getHash(e)%(e+1)}},{key:"allowSampleStoppingPoint",value:function(){return!0}},{key:"sample",value:function(e,t){for(var n=e.length,r=n-t,i=this.allowSampleStoppingPoint(),o=n-1;o>0;o--){var u=this.sampleIndexCalculation(o),a=e[o];if(e[o]=e[u],e[u]=a,i&&r===o)return e.slice(o,n)}return e.slice(0,t)}},{key:"simpleExecute",value:function(){var e,t=(0,a.shallowCopy)(this.getArgList("choices"));return e=void 0!==this.args.draws?this.getArgNumber("draws"):t.length,this.sample(t,e)}}]),n}()},t.WeightedChoiceBuilder=function(e){return function(t){function n(){return s(this,n),l(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return c(n,e),i(n,[{key:"simpleExecute",value:function(){var e=this.getArgList("choices"),t=this.getArgList("weights");if(0===e.length)return[];for(var n=0,r=t.map(function(e){return n+=e}),i=this.getUniform(0,n),o=0;o<r.length;++o)if(i<=r[o])return e[o]}}]),n}()},t.UniformChoiceBuilder=function(e){return function(t){function n(){return s(this,n),l(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return c(n,e),i(n,[{key:"randomIndexCalculation",value:function(e){return this.getHash()%e.length}},{key:"simpleExecute",value:function(){var e=this.getArgList("choices");return 0===e.length?[]:e[this.randomIndexCalculation(e)]}}]),n}()},t.BernoulliFilterBuilder=function(e){return function(t){function n(){return s(this,n),l(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return c(n,e),i(n,[{key:"simpleExecute",value:function(){var e=this.getArgNumber("p"),t=this.getArgList("choices");if(e<0||e>1)throw"Invalid probability";if(0==t.length)return[];for(var n=[],r=0;r<t.length;r++){var i=t[r];this.getUniform(0,1,i)<=e&&n.push(i)}return n}}]),n}()},t.BernoulliTrialBuilder=function(e){return function(t){function n(){return s(this,n),l(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return c(n,e),i(n,[{key:"simpleExecute",value:function(){var e=this.getArgNumber("p");if(e<0||e>1)throw"Invalid probability";return this.getUniform(0,1)<=e?1:0}}]),n}()},t.RandomIntegerBuilder=function(e){return function(t){function n(){return s(this,n),l(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return c(n,e),i(n,[{key:"randomIntegerCalculation",value:function(e,t){return(this.getHash()+e)%(t-e+1)}},{key:"simpleExecute",value:function(){var e=this.getArgNumber("min"),t=this.getArgNumber("max");return this.randomIntegerCalculation(e,t)}}]),n}()},t.RandomFloatBuilder=function(e){return function(t){function n(){return s(this,n),l(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return c(n,e),i(n,[{key:"simpleExecute",value:function(){var e=this.getArgNumber("min"),t=this.getArgNumber("max");return this.getUniform(e,t)}}]),n}()}},function(e,t,n){var r,i,o,u;r=n(14),i=n(15).utf8,o=n(15).bin,(u=function(e,t){var n=r.wordsToBytes(function(e){e.constructor==String?e=i.stringToBytes(e):"undefined"!=typeof Buffer&&"function"==typeof Buffer.isBuffer&&Buffer.isBuffer(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||(e=e.toString());var t=r.bytesToWords(e),n=8*e.length,o=[],u=1732584193,a=-271733879,s=-1732584194,l=271733878,c=-1009589776;t[n>>5]|=128<<24-n%32,t[15+(n+64>>>9<<4)]=n;for(var f=0;f<t.length;f+=16){for(var p=u,h=a,g=s,v=l,y=c,m=0;m<80;m++){if(m<16)o[m]=t[f+m];else{var d=o[m-3]^o[m-8]^o[m-14]^o[m-16];o[m]=d<<1|d>>>31}var _=(u<<5|u>>>27)+c+(o[m]>>>0)+(m<20?1518500249+(a&s|~a&l):m<40?1859775393+(a^s^l):m<60?(a&s|a&l|s&l)-1894007588:(a^s^l)-899497514);c=l,l=s,s=a<<30|a>>>2,a=u,u=_}u+=p,a+=h,s+=g,l+=v,c+=y}return[u,a,s,l,c]}(e));return t&&t.asBytes?n:t&&t.asString?o.bytesToString(n):r.bytesToHex(n)})._blocksize=16,u._digestsize=20,e.exports=u},function(e,t){var n,r;n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e.exports=r={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&r.rotl(e,8)|4278255360&r.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=r.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],n=0,r=0;n<e.length;n++,r+=8)t[r>>>5]|=e[n]<<24-r%32;return t},wordsToBytes:function(e){for(var t=[],n=0;n<32*e.length;n+=8)t.push(e[n>>>5]>>>24-n%32&255);return t},bytesToHex:function(e){for(var t=[],n=0;n<e.length;n++)t.push((e[n]>>>4).toString(16)),t.push((15&e[n]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(parseInt(e.substr(n,2),16));return t},bytesToBase64:function(e){for(var t=[],r=0;r<e.length;r+=3)for(var i=e[r]<<16|e[r+1]<<8|e[r+2],o=0;o<4;o++)t.push(8*r+6*o<=8*e.length?n.charAt(i>>>6*(3-o)&63):"=");return t.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var t=[],r=0,i=0;r<e.length;i=++r%4)0!=i&&t.push((n.indexOf(e.charAt(r-1))&Math.pow(2,-2*i+8)-1)<<2*i|n.indexOf(e.charAt(r))>>>6-2*i);return t}}},function(e,t){var n={utf8:{stringToBytes:function(e){return n.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(n.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t},bytesToString:function(e){for(var t=[],n=0;n<e.length;n++)t.push(String.fromCharCode(e[n]));return t.join("")}}};e.exports=n}])});